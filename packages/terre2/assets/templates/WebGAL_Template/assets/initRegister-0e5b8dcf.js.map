{"version":3,"file":"initRegister-0e5b8dcf.js","sources":["../../src/Core/gameScripts/pixi/performs/cherryBlossoms.ts","../../src/Core/gameScripts/pixi/performs/rain.ts","../../src/Core/gameScripts/pixi/performs/snow.ts"],"sourcesContent":["import * as PIXI from 'pixi.js';\nimport { registerPerform } from '@/Core/util/pixiPerformManager/pixiPerformManager';\n\nimport { WebGAL } from '@/Core/WebGAL';\nimport { SCREEN_CONSTANTS } from '@/Core/util/constants';\n\nconst pixicherryBlossoms = (cherryBlossomsSpeed: number) => {\n  // アニメーション パラメータ\n  // 倍率を設定\n  // 动画参数\n  // 设置缩放的系数\n  const scalePreset = 0.15;\n\n  const effectsContainer = WebGAL!.gameplay!.pixiStage!.effectsContainer;\n  const app = WebGAL!.gameplay!.pixiStage!.currentApp!;\n  const container = new PIXI.Container();\n  effectsContainer.addChild(container);\n  // テクスチャを作成\n  // 创建纹理\n  const texture = PIXI.Texture.from('./game/tex/cherryBlossoms.png');\n  // コンテナを中央に移動\n  // 将容器移到中心\n  container.x = app.screen.width / 2;\n  container.y = app.screen.height / 2;\n  container.pivot.x = container.width / 2;\n  container.pivot.y = container.height / 2;\n  // ズームを調整\n  // 调整缩放\n  container.scale.x = 1;\n  container.scale.y = 1;\n  // container.rotation = -0.2;\n  const bunnyList: any = [];\n  // アニメーションの更新を監視\n  // 监听动画更新\n  function tickerFn(delta: number) {\n    // 桜の位置を制御するために使用される長さと幅を取得します\n    // 获取长宽，用于控制花出现位置\n    const stageWidth = SCREEN_CONSTANTS.width;\n    const stageHeight = SCREEN_CONSTANTS.height;\n    // オブジェクトを作成\n    // 创建对象\n    const bunny = new PIXI.Sprite(texture);\n    let scaleRand = 0.25;\n\n    bunny.scale.x = scalePreset * scaleRand;\n    bunny.scale.y = scalePreset * scaleRand;\n    // アンカーポイントを設定\n    // 设置锚点\n    bunny.anchor.set(0.5);\n    // ランダムな桜の位置\n    // 随机花位置\n    bunny.x = Math.random() * stageWidth - 0.5 * stageWidth;\n    bunny.y = 0 - 0.5 * stageHeight;\n    // @ts-ignore\n    bunny['dropSpeed'] = Math.random() * 5;\n    // @ts-ignore\n    bunny['acc'] = Math.random();\n    container.addChild(bunny);\n    bunnyList.push(bunny);\n\n    let count = 0;\n    for (const e of bunnyList) {\n      count++;\n      const randomNumber = Math.random();\n      e['dropSpeed'] = e['acc'] * 0.01 + e['dropSpeed'];\n      e.y += delta * cherryBlossomsSpeed * e['dropSpeed'] * 0.3 + 0.7;\n      const addX = count % 2 === 0;\n      if (addX) {\n        e.x += delta * randomNumber * 0.5;\n        e.rotation += delta * randomNumber * 0.03;\n      } else {\n        e.x -= delta * randomNumber * 0.5;\n        e.rotation -= delta * randomNumber * 0.03;\n      }\n    }\n    // 同じ画面上の桜の数を制御します\n    // 控制同屏花数\n    if (bunnyList.length >= 200) {\n      bunnyList.shift()?.destroy();\n      container.removeChild(container.children[0]);\n    }\n  }\n  WebGAL!.gameplay!.pixiStage!.registerAnimation(\n    { setStartState: () => {}, setEndState: () => {}, tickerFunc: tickerFn },\n    'cherryBlossoms-Ticker',\n  );\n  return { container, tickerKey: 'cherryBlossoms-Ticker' };\n};\n\nregisterPerform('cherryBlossoms', () => pixicherryBlossoms(3));\n","import * as PIXI from 'pixi.js';\nimport { registerPerform } from '@/Core/util/pixiPerformManager/pixiPerformManager';\n\nimport { WebGAL } from '@/Core/WebGAL';\nimport { SCREEN_CONSTANTS } from '@/Core/util/constants';\n\nconst pixiRain = (rainSpeed: number, number: number) => {\n  // 动画参数\n  // 设置缩放的系数\n  const scalePreset = 0.48;\n\n  const effectsContainer = WebGAL.gameplay.pixiStage!.effectsContainer!;\n  const app = WebGAL.gameplay.pixiStage!.currentApp!;\n  const container = new PIXI.Container();\n  effectsContainer.addChild(container);\n  // 创建纹理\n  const texture = PIXI.Texture.from('./game/tex/raindrop.png');\n  // 将容器移到中心\n  container.x = app.screen.width / 2;\n  container.y = app.screen.height / 2;\n  container.pivot.x = container.width / 2;\n  container.pivot.y = container.height / 2;\n  // 调整缩放\n  container.scale.x = 1;\n  container.scale.y = 1;\n  // container.rotation = -0.2;\n  const bunnyList: PIXI.Sprite[] = [];\n  // 监听动画更新\n  function ticker(delta: number) {\n    // 获取长宽，用于控制雪花出现位置\n    const stageWidth = SCREEN_CONSTANTS.width;\n    const stageHeight = SCREEN_CONSTANTS.height;\n    for (let i = 0; i < number; i++) {\n      // 创建对象\n      const bunny = new PIXI.Sprite(texture);\n      // 随机雨点大小\n      let scaleRand = Math.random();\n      if (scaleRand <= 0.5) {\n        scaleRand = 0.5;\n      }\n      bunny.scale.x = scalePreset * scaleRand;\n      bunny.scale.y = scalePreset * scaleRand;\n      // 设置锚点\n      bunny.anchor.set(0.5);\n      // 随机雪花位置\n      bunny.x = Math.random() * stageWidth - 0.5 * stageWidth;\n      bunny.y = 0 - 0.5 * stageHeight;\n      // @ts-ignore\n      bunny['dropSpeed'] = Math.random() * 2;\n      // @ts-ignore\n      bunny['acc'] = Math.random();\n      bunny['alpha'] = Math.random();\n      if (bunny['alpha'] >= 0.5) {\n        bunny['alpha'] = 0.5;\n      }\n      if (bunny['alpha'] <= 0.2) {\n        bunny['alpha'] = 0.2;\n      }\n      container.addChild(bunny);\n      // 控制每片雨点\n      bunnyList.push(bunny);\n\n      // 控制同屏雨点数\n      if (bunnyList.length >= 2500) {\n        bunnyList.shift()?.destroy();\n        container.removeChild(container.children[0]);\n      }\n    }\n    // 雨点落下\n    for (const e of bunnyList) {\n      // @ts-ignore\n      e['dropSpeed'] = e['acc'] * 0.01 + e['dropSpeed'];\n      // @ts-ignore\n      e.y += delta * rainSpeed * e['dropSpeed'] * 1.1 + 3;\n    }\n  }\n  WebGAL.gameplay.pixiStage?.registerAnimation(\n    { setStartState: () => {}, setEndState: () => {}, tickerFunc: ticker },\n    'rain-Ticker',\n  );\n  return { container, tickerKey: 'rain-Ticker' };\n};\n\nregisterPerform('rain', () => pixiRain(6, 10));\n","import * as PIXI from 'pixi.js';\nimport { registerPerform } from '@/Core/util/pixiPerformManager/pixiPerformManager';\n\nimport { WebGAL } from '@/Core/WebGAL';\nimport { SCREEN_CONSTANTS } from '@/Core/util/constants';\n\nconst pixiSnow = (snowSpeed: number) => {\n  // 动画参数\n  // 设置缩放的系数\n  const scalePreset = 0.144;\n\n  const effectsContainer = WebGAL.gameplay.pixiStage!.effectsContainer!;\n  const app = WebGAL.gameplay.pixiStage!.currentApp!;\n  const container = new PIXI.Container();\n  effectsContainer.addChild(container);\n  // 创建纹理\n  const texture = PIXI.Texture.from('./game/tex/snowFlake_min.png');\n  // 将容器移到中心\n  container.x = app.screen.width / 2;\n  container.y = app.screen.height / 2;\n  container.pivot.x = container.width / 2;\n  container.pivot.y = container.height / 2;\n  // 调整缩放\n  container.scale.x = 1;\n  container.scale.y = 1;\n  // container.rotation = -0.2;\n  const bunnyList: any = [];\n  // 监听动画更新\n  function tickerFn(delta: number) {\n    // 获取长宽，用于控制雪花出现位置\n    const stageWidth = SCREEN_CONSTANTS.width;\n    const stageHeight = SCREEN_CONSTANTS.height;\n    // 创建对象\n    const bunny = new PIXI.Sprite(texture);\n    // 随机雪花大小\n    let scaleRand = Math.random();\n    if (scaleRand <= 0.5) {\n      scaleRand = 0.5;\n    }\n    bunny.scale.x = scalePreset * scaleRand;\n    bunny.scale.y = scalePreset * scaleRand;\n    // 设置锚点\n    bunny.anchor.set(0.5);\n    // 随机雪花位置\n    bunny.x = Math.random() * stageWidth - 0.5 * stageWidth;\n    bunny.y = 0 - 0.5 * stageHeight;\n    // @ts-ignore\n    bunny['dropSpeed'] = Math.random() * 2;\n    // @ts-ignore\n    bunny['acc'] = Math.random();\n    container.addChild(bunny);\n    // 控制每片雪花\n    bunnyList.push(bunny);\n    let count = 0; // 用于判断雪花往左还是往右飘，是2的倍数则往左\n    for (const e of bunnyList) {\n      count++;\n      const randomNumber = Math.random();\n      e['dropSpeed'] = e['acc'] * 0.01 + e['dropSpeed'];\n      e.y += delta * snowSpeed * e['dropSpeed'] * 0.3 + 0.7;\n      const addX = count % 2 === 0;\n      if (addX) {\n        e.x += delta * randomNumber * 0.5;\n        e.rotation += delta * randomNumber * 0.03;\n      } else {\n        e.x -= delta * randomNumber * 0.5;\n        e.rotation -= delta * randomNumber * 0.03;\n      }\n    }\n    // 控制同屏雪花数\n    if (bunnyList.length >= 500) {\n      bunnyList.shift()?.destroy();\n      container.removeChild(container.children[0]);\n    }\n  }\n  WebGAL.gameplay.pixiStage?.registerAnimation(\n    { setStartState: () => {}, setEndState: () => {}, tickerFunc: tickerFn },\n    'snow-Ticker',\n  );\n  return { container, tickerKey: 'snow-Ticker' };\n};\n\nregisterPerform('snow', () => pixiSnow(3));\n"],"names":["pixicherryBlossoms","cherryBlossomsSpeed","effectsContainer","WebGAL","app","container","PIXI.Container","texture","PIXI.Texture","bunnyList","tickerFn","delta","stageWidth","SCREEN_CONSTANTS","stageHeight","bunny","PIXI.Sprite","scaleRand","count","e","randomNumber","_a","registerPerform","pixiRain","rainSpeed","number","ticker","i","pixiSnow","snowSpeed"],"mappings":"sEAMA,MAAMA,EAAsBC,GAAgC,CAOpD,MAAAC,EAAmBC,EAAQ,SAAU,UAAW,iBAChDC,EAAMD,EAAQ,SAAU,UAAW,WACnCE,EAAY,IAAIC,EACtBJ,EAAiB,SAASG,CAAS,EAGnC,MAAME,EAAUC,EAAa,KAAK,+BAA+B,EAGvDH,EAAA,EAAID,EAAI,OAAO,MAAQ,EACvBC,EAAA,EAAID,EAAI,OAAO,OAAS,EACxBC,EAAA,MAAM,EAAIA,EAAU,MAAQ,EAC5BA,EAAA,MAAM,EAAIA,EAAU,OAAS,EAGvCA,EAAU,MAAM,EAAI,EACpBA,EAAU,MAAM,EAAI,EAEpB,MAAMI,EAAiB,CAAA,EAGvB,SAASC,EAASC,EAAe,OAG/B,MAAMC,EAAaC,EAAiB,MAC9BC,EAAcD,EAAiB,OAG/BE,EAAQ,IAAIC,EAAYT,CAAO,EACrC,IAAIU,EAAY,IAEVF,EAAA,MAAM,EAAI,IAAcE,EACxBF,EAAA,MAAM,EAAI,IAAcE,EAGxBF,EAAA,OAAO,IAAI,EAAG,EAGpBA,EAAM,EAAI,KAAK,OAAO,EAAIH,EAAa,GAAMA,EACvCG,EAAA,EAAI,EAAI,GAAMD,EAEpBC,EAAM,UAAe,KAAK,OAAA,EAAW,EAE/BA,EAAA,IAAS,KAAK,OAAO,EAC3BV,EAAU,SAASU,CAAK,EACxBN,EAAU,KAAKM,CAAK,EAEpB,IAAIG,EAAQ,EACZ,UAAWC,KAAKV,EAAW,CACzBS,IACM,MAAAE,EAAe,KAAK,SAC1BD,EAAE,UAAeA,EAAE,IAAS,IAAOA,EAAE,UACrCA,EAAE,GAAKR,EAAQV,EAAsBkB,EAAE,UAAe,GAAM,GAC/CD,EAAQ,IAAM,GAEvBC,EAAA,GAAKR,EAAQS,EAAe,GAC5BD,EAAA,UAAYR,EAAQS,EAAe,MAEnCD,EAAA,GAAKR,EAAQS,EAAe,GAC5BD,EAAA,UAAYR,EAAQS,EAAe,IAEzC,CAGIX,EAAU,QAAU,OACZY,EAAAZ,EAAA,UAAA,MAAAY,EAAS,UACnBhB,EAAU,YAAYA,EAAU,SAAS,CAAC,CAAC,EAE/C,CACA,OAAAF,EAAQ,SAAU,UAAW,kBAC3B,CAAE,cAAe,IAAM,CAAC,EAAG,YAAa,IAAM,CAAA,EAAI,WAAYO,CAAS,EACvE,uBAAA,EAEK,CAAE,UAAAL,EAAW,UAAW,wBACjC,EAEAiB,EAAgB,iBAAkB,IAAMtB,EAAmB,CAAC,CAAC,ECnF7D,MAAMuB,EAAW,CAACC,EAAmBC,IAAmB,OAKhD,MAAAvB,EAAmBC,EAAO,SAAS,UAAW,iBAC9CC,EAAMD,EAAO,SAAS,UAAW,WACjCE,EAAY,IAAIC,EACtBJ,EAAiB,SAASG,CAAS,EAEnC,MAAME,EAAUC,EAAa,KAAK,yBAAyB,EAEjDH,EAAA,EAAID,EAAI,OAAO,MAAQ,EACvBC,EAAA,EAAID,EAAI,OAAO,OAAS,EACxBC,EAAA,MAAM,EAAIA,EAAU,MAAQ,EAC5BA,EAAA,MAAM,EAAIA,EAAU,OAAS,EAEvCA,EAAU,MAAM,EAAI,EACpBA,EAAU,MAAM,EAAI,EAEpB,MAAMI,EAA2B,CAAA,EAEjC,SAASiB,EAAOf,EAAe,OAE7B,MAAMC,EAAaC,EAAiB,MAC9BC,EAAcD,EAAiB,OACrC,QAASc,EAAI,EAAGA,EAAIF,EAAQE,IAAK,CAE/B,MAAMZ,EAAQ,IAAIC,EAAYT,CAAO,EAEjC,IAAAU,EAAY,KAAK,SACjBA,GAAa,KACHA,EAAA,IAERF,EAAA,MAAM,EAAI,IAAcE,EACxBF,EAAA,MAAM,EAAI,IAAcE,EAExBF,EAAA,OAAO,IAAI,EAAG,EAEpBA,EAAM,EAAI,KAAK,OAAO,EAAIH,EAAa,GAAMA,EACvCG,EAAA,EAAI,EAAI,GAAMD,EAEpBC,EAAM,UAAe,KAAK,OAAA,EAAW,EAE/BA,EAAA,IAAS,KAAK,OAAO,EACrBA,EAAA,MAAW,KAAK,OAAO,EACzBA,EAAM,OAAY,KACpBA,EAAM,MAAW,IAEfA,EAAM,OAAY,KACpBA,EAAM,MAAW,IAEnBV,EAAU,SAASU,CAAK,EAExBN,EAAU,KAAKM,CAAK,EAGhBN,EAAU,QAAU,QACZY,EAAAZ,EAAA,UAAA,MAAAY,EAAS,UACnBhB,EAAU,YAAYA,EAAU,SAAS,CAAC,CAAC,EAE/C,CAEA,UAAWc,KAAKV,EAEdU,EAAE,UAAeA,EAAE,IAAS,IAAOA,EAAE,UAErCA,EAAE,GAAKR,EAAQa,EAAYL,EAAE,UAAe,IAAM,CAEtD,CACA,OAAAE,EAAAlB,EAAO,SAAS,YAAhB,MAAAkB,EAA2B,kBACzB,CAAE,cAAe,IAAM,CAAC,EAAG,YAAa,IAAM,CAAA,EAAI,WAAYK,CAAO,EACrE,eAEK,CAAE,UAAArB,EAAW,UAAW,cACjC,EAEAiB,EAAgB,OAAQ,IAAMC,EAAS,EAAG,EAAE,CAAC,EC7E7C,MAAMK,EAAYC,GAAsB,OAKhC,MAAA3B,EAAmBC,EAAO,SAAS,UAAW,iBAC9CC,EAAMD,EAAO,SAAS,UAAW,WACjCE,EAAY,IAAIC,EACtBJ,EAAiB,SAASG,CAAS,EAEnC,MAAME,EAAUC,EAAa,KAAK,8BAA8B,EAEtDH,EAAA,EAAID,EAAI,OAAO,MAAQ,EACvBC,EAAA,EAAID,EAAI,OAAO,OAAS,EACxBC,EAAA,MAAM,EAAIA,EAAU,MAAQ,EAC5BA,EAAA,MAAM,EAAIA,EAAU,OAAS,EAEvCA,EAAU,MAAM,EAAI,EACpBA,EAAU,MAAM,EAAI,EAEpB,MAAMI,EAAiB,CAAA,EAEvB,SAASC,EAASC,EAAe,OAE/B,MAAMC,EAAaC,EAAiB,MAC9BC,EAAcD,EAAiB,OAE/BE,EAAQ,IAAIC,EAAYT,CAAO,EAEjC,IAAAU,EAAY,KAAK,SACjBA,GAAa,KACHA,EAAA,IAERF,EAAA,MAAM,EAAI,KAAcE,EACxBF,EAAA,MAAM,EAAI,KAAcE,EAExBF,EAAA,OAAO,IAAI,EAAG,EAEpBA,EAAM,EAAI,KAAK,OAAO,EAAIH,EAAa,GAAMA,EACvCG,EAAA,EAAI,EAAI,GAAMD,EAEpBC,EAAM,UAAe,KAAK,OAAA,EAAW,EAE/BA,EAAA,IAAS,KAAK,OAAO,EAC3BV,EAAU,SAASU,CAAK,EAExBN,EAAU,KAAKM,CAAK,EACpB,IAAIG,EAAQ,EACZ,UAAWC,KAAKV,EAAW,CACzBS,IACM,MAAAE,EAAe,KAAK,SAC1BD,EAAE,UAAeA,EAAE,IAAS,IAAOA,EAAE,UACrCA,EAAE,GAAKR,EAAQkB,EAAYV,EAAE,UAAe,GAAM,GACrCD,EAAQ,IAAM,GAEvBC,EAAA,GAAKR,EAAQS,EAAe,GAC5BD,EAAA,UAAYR,EAAQS,EAAe,MAEnCD,EAAA,GAAKR,EAAQS,EAAe,GAC5BD,EAAA,UAAYR,EAAQS,EAAe,IAEzC,CAEIX,EAAU,QAAU,OACZY,EAAAZ,EAAA,UAAA,MAAAY,EAAS,UACnBhB,EAAU,YAAYA,EAAU,SAAS,CAAC,CAAC,EAE/C,CACA,OAAAgB,EAAAlB,EAAO,SAAS,YAAhB,MAAAkB,EAA2B,kBACzB,CAAE,cAAe,IAAM,CAAC,EAAG,YAAa,IAAM,CAAA,EAAI,WAAYX,CAAS,EACvE,eAEK,CAAE,UAAAL,EAAW,UAAW,cACjC,EAEAiB,EAAgB,OAAQ,IAAMM,EAAS,CAAC,CAAC"}